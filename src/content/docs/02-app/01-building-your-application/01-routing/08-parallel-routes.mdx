---
title: 平行路线
description: 同时呈现同一视图中可以独立导航的一个或多个页面。用于高度动态应用程序的模式。
---

并行路由允许您同时或有条件地呈现同一布局中的一个或多个页面。对于应用程序的高度动态部分，如社交网站上的仪表板和提要，并行路由可用于实现复杂的路由模式。

例如，您可以同时呈现团队页面和分析页面。

<Image
  alt="Parallel Routes Diagram"
  srclight="/docs/light/parallel-routes.png"
  srcdark="/docs/dark/parallel-routes.png"
  width="1600"
  height="952"
/>

并行路由允许您为每条路由定义独立的错误和加载状态，因为它们是独立流入的。

<Image
  alt="Parallel routes enable custom error and loading states"
  srclight="/docs/light/parallel-routes-cinematic-universe.png"
  srcdark="/docs/dark/parallel-routes-cinematic-universe.png"
  width="1600"
  height="1218"
/>

并行路由还允许您根据某些条件（如身份验证状态）有条件地呈现插槽。这将在同一 URL 上启用完全分离的代码。

<Image
  alt="Conditional routes diagram"
  srclight="/docs/light/conditional-routes-ui.png"
  srcdark="/docs/dark/conditional-routes-ui.png"
  width="1600"
  height="898"
/>

## 习俗

Parallel routes are created using named **slots**. Slots are defined with the `@folder` convention, and are passed to the same-level layout as props.

> Slots are _not_ route segments and _do not affect the URL structure_. The file path `/@team/members` would be accessible at `/members`.

For example, the following file structure defines two explicit slots: `@analytics` and `@team`.

<Image
  alt="Parallel Routes File-system Structure"
  srclight="/docs/light/parallel-routes-file-system.png"
  srcdark="/docs/dark/parallel-routes-file-system.png"
  width="1600"
  height="687"
/>

The folder structure above means that the component in `app/layout.js` now accepts the `@analytics` and `@team` slots props, and can render them in parallel alongside the `children` prop:

```tsx filename="app/layout.tsx" switcher
export default function Layout(props: {
  children: React.ReactNode;
  analytics: React.ReactNode;
  team: React.ReactNode;
}) {
  return (
    <>
      {props.children}
      {props.team}
      {props.analytics}
    </>
  );
}
```

```jsx filename="app/layout.js" switcher
export default function Layout(props) {
  return (
    <>
      {props.children}
      {props.team}
      {props.analytics}
    </>
  );
}
```

> **Good to know**: The `children` prop is an implicit slot that does not need to be mapped to a folder. This means `app/page.js` is equivalent to `app/@children/page.js`.

## 不匹配的路由

By default, the content rendered within a slot will match the current URL.

In the case of an unmatched slot, the content that Next.js renders differs based on the routing technique and folder structure.

### `default.js`

You can define a `default.js` file to render as a fallback when Next.js cannot recover a slot's active state based on the current URL.

Consider the following folder structure. The `@team` slot has a `settings` directory, but `@analytics` does not.

<Image
  alt="Parallel Routes unmatched routes"
  srclight="/docs/light/parallel-routes-unmatched-routes.png"
  srcdark="/docs/dark/parallel-routes-unmatched-routes.png"
  width="1600"
  height="930"
/>

#### 导航

On navigation, Next.js will render the slot's previously active state, even if it doesn't match the current URL.

#### 重新加载

On reload, Next.js will first try to render the unmatched slot's `default.js` file. If that's not available, a 404 gets rendered.

> The 404 for unmatched routes helps ensure that you don't accidentally render a route that shouldn't be parallel rendered.

## `useSelectedLayoutSegment(s)`

Both [`useSelectedLayoutSegment`](/docs/app/api-reference/functions/use-selected-layout-segment) and [`useSelectedLayoutSegments`](/docs/app/api-reference/functions/use-selected-layout-segments) accept a `parallelRoutesKey`, which allows you to read the active route segment within that slot.

```tsx filename="app/layout.tsx" switcher
"use client";

import { useSelectedLayoutSegment } from "next/navigation";

export default async function Layout(props: {
  //...
  auth: React.ReactNode;
}) {
  const loginSegments = useSelectedLayoutSegment("auth");
  // ...
}
```

```jsx filename="app/layout.js" switcher
"use client";

import { useSelectedLayoutSegment } from "next/navigation";

export default async function Layout(props) {
  const loginSegments = useSelectedLayoutSegment("auth");
  // ...
}
```

When a user navigates to `@auth/login`, or `/login` in the URL bar, `loginSegments` will be equal to the string `"login"`.

## 示例

### 模式

并行路由可用于渲染模式。

<Image
  alt="Parallel Routes Diagram"
  srclight="/docs/light/parallel-routes-auth-modal.png"
  srcdark="/docs/dark/parallel-routes-auth-modal.png"
  width="1600"
  height="687"
/>

The `@auth` slot renders a `<Modal>` component that can be shown by navigating to a matching route, for example `/login`.

```tsx filename="app/layout.tsx" switcher
export default async function Layout(props: {
  // ...
  auth: React.ReactNode;
}) {
  return (
    <>
      {/* ... */}
      {props.auth}
    </>
  );
}
```

```jsx filename="app/layout.js" switcher
export default async function Layout(props) {
  return (
    <>
      {/* ... */}
      {props.auth}
    </>
  );
}
```

```tsx filename="app/@auth/login/page.tsx" switcher
import { Modal } from "components/modal";

export default function Login() {
  return (
    <Modal>
      <h1>Login</h1>
      {/* ... */}
    </Modal>
  );
}
```

```jsx filename="app/@auth/login/page.js" switcher
import { Modal } from "components/modal";

export default function Login() {
  return (
    <Modal>
      <h1>Login</h1>
      {/* ... */}
    </Modal>
  );
}
```

To ensure that the contents of the modal don't get rendered when it's not active, you can create a `default.js` file that returns `null`.

```tsx filename="app/@auth/default.tsx" switcher
export default function Default() {
  return null;
}
```

```jsx filename="app/@auth/default.js" switcher
export default function Default() {
  return null;
}
```

#### 取消模态

If a modal was initiated through client navigation, e.g. by using `<Link href="/login">`, you can dismiss the modal by calling `router.back()` or by using a `Link` component.

```tsx filename="app/@auth/login/page.tsx" highlight="5" switcher
"use client";
import { useRouter } from "next/navigation";
import { Modal } from "components/modal";

export default async function Login() {
  const router = useRouter();
  return (
    <Modal>
      <span onClick={() => router.back()}>Close modal</span>
      <h1>Login</h1>
      ...
    </Modal>
  );
}
```

```jsx filename="app/@auth/login/page.js" highlight="5" switcher
"use client";
import { useRouter } from "next/navigation";
import { Modal } from "components/modal";

export default async function Login() {
  const router = useRouter();
  return (
    <Modal>
      <span onClick={() => router.back()}>Close modal</span>
      <h1>Login</h1>
      ...
    </Modal>
  );
}
```

> More information on modals is covered in the [Intercepting Routes](/docs/app/building-your-application/routing/intercepting-routes) section.

If you want to navigate elsewhere and dismiss a modal, you can also use a catch-all route.

<Image
  alt="Parallel Routes Diagram"
  srclight="/docs/light/parallel-routes-catchall.png"
  srcdark="/docs/dark/parallel-routes-catchall.png"
  width="1600"
  height="768"
/>

```tsx filename="app/@auth/[...catchAll]/page.tsx" switcher
export default function CatchAll() {
  return null;
}
```

```jsx filename="app/@auth/[...catchAll]/page.js" switcher
export default function CatchAll() {
  return null;
}
```

> Catch-all routes take precedence over `default.js`.

### Conditional Routes

Parallel Routes can be used to implement conditional routing. For example, you can render a `@dashboard` or `@login` route depending on the authentication state.

```tsx filename="app/layout.tsx" switcher
import { getUser } from "@/lib/auth";

export default function Layout({ dashboard, login }: { dashboard: React.ReactNode; login: React.ReactNode }) {
  const isLoggedIn = getUser();
  return isLoggedIn ? dashboard : login;
}
```

```jsx filename="app/layout.js" switcher
import { getUser } from "@/lib/auth";

export default function Layout({ dashboard, login }) {
  const isLoggedIn = getUser();
  return isLoggedIn ? dashboard : login;
}
```

<Image
  alt="Parallel routes authentication example"
  srclight="/docs/light/conditional-routes-ui.png"
  srcdark="/docs/dark/conditional-routes-ui.png"
  width="1600"
  height="898"
/>
